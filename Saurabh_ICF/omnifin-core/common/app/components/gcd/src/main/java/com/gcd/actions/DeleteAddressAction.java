/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package com.gcd.actions;

import javax.servlet.ServletContext;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;
import org.apache.log4j.Logger;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.actions.DispatchAction;

import com.connect.CommonFunction;
import com.connect.DaoImplInstanceFactory;
import com.gcd.dao.CorporateDAO;
import com.logger.LoggerMsg;
import com.login.dao.UserSessionCheck;
import com.login.roleManager.UserObject;

/** 
 * MyEclipse Struts
 * Creation date: 03-30-2011
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class DeleteAddressAction extends DispatchAction {
	private static final Logger logger = Logger.getLogger(DeleteAddressAction.class.getName());
	/*
	 * Generated Methods
	 */

	/** 
	 * Method execute
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward delete_address(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
	
		 LoggerMsg.info("In CustomerAddressAction in delete_address");
		
		    HttpSession session = request.getSession();
			UserObject userobj=(UserObject)session.getAttribute("userobject");
			
			Object sessionId = session.getAttribute("sessionID");
			ServletContext context = getServlet().getServletContext();
			String strFlag="";	
			if(sessionId!=null)
			{
				strFlag = UserSessionCheck.checkSameUserSession(userobj,sessionId.toString(),"",request);
			}
			
			logger.info("strFlag .............. "+strFlag);
			if(!strFlag.equalsIgnoreCase(""))
			{
				if(strFlag.equalsIgnoreCase("sameUserSession"))
				{
					context.removeAttribute("msg");
					context.removeAttribute("msg1");
				}
				else if(strFlag.equalsIgnoreCase("BODCheck"))
				{
					context.setAttribute("msg", "B");
				}
				return mapping.findForward("logout");
			}
			//code added by neeraj
			String source="NE";
			String functionId=(String)session.getAttribute("functionId");
			int funid=Integer.parseInt(functionId);		
			if(funid==4000122 || funid==4000123)
				source="ED";
			//neeraj space end
		 int status=0;
		 CorporateDAO detail=(CorporateDAO)DaoImplInstanceFactory.getDaoImplInstance(CorporateDAO.IDENTITY);
			logger.info("Implementation class: "+detail.getClass());
		 String statusCase="";
		 String updateInMaker="";
		 String updateFlag="";
		 if(session.getAttribute("statusCase")!=null)
		 {
				statusCase = session.getAttribute("statusCase").toString();
		 }	
		 if(session.getAttribute("updateInMaker")!=null)
		 {
			 updateInMaker = session.getAttribute("updateInMaker").toString();
		 }
		 if(session.getAttribute("updateFlag")!=null)
		    {
		    	updateFlag=session.getAttribute("updateFlag").toString();
		    		
		    }
		 Object pageStatus =null;
		 if(session.getAttribute("operation")!=null||session.getAttribute("approve")!=null)
		 {
			 	
			 pageStatus = session.getAttribute("approve");
		 }
		 String pageStatuss="";
		 if(session.getAttribute("pageStatuss")!=null)
		 {
			 pageStatuss = session.getAttribute("pageStatuss").toString();
		 }
		 String addr_id[] = request.getParameterValues("chk");
		 for(int k=0;k<addr_id.length;k++)
		 {
			 logger.info("Address id:--"+addr_id[k]);
			 status = detail.deleteCustomerAddress(addr_id[k],updateInMaker,statusCase,pageStatus,pageStatuss,updateFlag,source);
		 }
		 String cusType="";
			
			if(session.getAttribute("cusType")!=null)
			{
				cusType=session.getAttribute("cusType").toString();
			}
			
		 if(status>0)
		 {
			 
				 session.removeAttribute("addrList");
				 session.removeAttribute("countryList");
				 session.removeAttribute("detailcountryList");
				 session.removeAttribute("detailcityList");
				 session.removeAttribute("detailregionList");
				 session.removeAttribute("individualInfo");
				 session.removeAttribute("addressInfo");
				 request.setAttribute("closeSuccess", "Updation is Completed Successfully!!!");
				 logger.info("-session.getAttribute(corporateId)----"+session.getAttribute("corporateId"));
				 String corporateId=CommonFunction.checkNull(session.getAttribute("corporateId")).trim();
				 
				 if(!CommonFunction.checkNull(corporateId).trim().equalsIgnoreCase(""))
				 {
					 logger.info("IN delete---------------");
					 return mapping.findForward("delete");
				 }
				 else
				 {
					 logger.info("IN deleteIndividusal---------------------");
					 return mapping.findForward("deleteIndividusal");
				 }
				 
     	  }
		  else
		  {
				 request.setAttribute("status", "Updation is failed!!!"); 
		  }
		return null;
	}
	
	public ActionForward delete_reference(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
	
		 LoggerMsg.info("In DeleteAddressAction in delete_reference");
		    HttpSession session = request.getSession();
			UserObject userobj=(UserObject)session.getAttribute("userobject");
			
			Object sessionId = session.getAttribute("sessionID");
			ServletContext context = getServlet().getServletContext();
			String strFlag="";	
			if(sessionId!=null)
			{
				strFlag = UserSessionCheck.checkSameUserSession(userobj,sessionId.toString(),"",request);
			}
			
			logger.info("strFlag .............. "+strFlag);
			if(!strFlag.equalsIgnoreCase(""))
			{
				if(strFlag.equalsIgnoreCase("sameUserSession"))
				{
					context.removeAttribute("msg");
					context.removeAttribute("msg1");
				}
				else if(strFlag.equalsIgnoreCase("BODCheck"))
				{
					context.setAttribute("msg", "B");
				}
				return mapping.findForward("logout");
			}
			//code added by neeraj
			String source="NE";
			String functionId=(String)session.getAttribute("functionId");
			int funid=Integer.parseInt(functionId);		
			if(funid==4000122 || funid==4000123)
				source="ED";
			//neeraj space end
		 int status=0;
		 CorporateDAO detail=(CorporateDAO)DaoImplInstanceFactory.getDaoImplInstance(CorporateDAO.IDENTITY);
			logger.info("Implementation class: "+detail.getClass());
		 String statusCase="";
		 String updateInMaker="";
		 String updateFlag="";
		 if(session.getAttribute("statusCase")!=null)
		 {
				statusCase = session.getAttribute("statusCase").toString();
		 }	
		 if(session.getAttribute("updateInMaker")!=null)
		 {
			 updateInMaker = session.getAttribute("updateInMaker").toString();
		 }
		 if(session.getAttribute("updateFlag")!=null)
		    {
		    	updateFlag=session.getAttribute("updateFlag").toString();
		    		
		    }
		 Object pageStatus =null;
		 if(session.getAttribute("operation")!=null||session.getAttribute("approve")!=null)
		 {
			 	
			 pageStatus = session.getAttribute("approve");
		 }
		 String pageStatuss="";
		 if(session.getAttribute("pageStatuss")!=null)
		 {
			 pageStatuss = session.getAttribute("pageStatuss").toString();
		 }
		 String addr_id[] = request.getParameterValues("chk");
		 for(int k=0;k<addr_id.length;k++)
		 {
			 logger.info("Address id:--"+addr_id[k]);
			 status = detail.deleteCustomerReference(addr_id[k],updateInMaker,statusCase,pageStatus,pageStatuss,updateFlag,source);
		 }
		 String cusType="";
			
			if(session.getAttribute("cusType")!=null)
			{
				cusType=session.getAttribute("cusType").toString();
			}
			
		 if(status>0)
		 {
			 
				 session.removeAttribute("addrList");
				 session.removeAttribute("countryList");
				 session.removeAttribute("detailcountryList");
				 session.removeAttribute("detailcityList");
				 session.removeAttribute("detailregionList");
				 session.removeAttribute("individualInfo");
				 session.removeAttribute("addressInfo");
				 request.setAttribute("closeSuccess", "Updation is Completed Successfully!!!");
				 logger.info("deleteIndReference");
				 if(session.getAttribute("idividualId")!=null)
					{
					 return mapping.findForward("deleteIndReference");
					}
				 else{
					 return mapping.findForward("deleteCorReference"); 
				 }
				 
				 
     	  }
		  else
		  {
				 request.setAttribute("status", "Updation is failed!!!"); 
		  }
		return null;
	}
	//Rohit Chaanges for Sarva Suraksha Starts
	public ActionForward delete_SarvaSuraksha(ActionMapping mapping, ActionForm form,
			HttpServletRequest request, HttpServletResponse response) throws Exception {
	
		 LoggerMsg.info("In DeleteAddressAction in delete_SarvaSuraksha");
		    HttpSession session = request.getSession();
			UserObject userobj=(UserObject)session.getAttribute("userobject");
			
			Object sessionId = session.getAttribute("sessionID");
			ServletContext context = getServlet().getServletContext();
			String strFlag="";	
			if(sessionId!=null)
			{
				strFlag = UserSessionCheck.checkSameUserSession(userobj,sessionId.toString(),"",request);
			}
			
			logger.info("strFlag .............. "+strFlag);
			if(!strFlag.equalsIgnoreCase(""))
			{
				if(strFlag.equalsIgnoreCase("sameUserSession"))
				{
					context.removeAttribute("msg");
					context.removeAttribute("msg1");
				}
				else if(strFlag.equalsIgnoreCase("BODCheck"))
				{
					context.setAttribute("msg", "B");
				}
				return mapping.findForward("logout");
			}
			//code added by neeraj
			String source="NE";
			String functionId=(String)session.getAttribute("functionId");
			int funid=Integer.parseInt(functionId);		
			if(funid==4000122 || funid==4000123)
				source="ED";
			//neeraj space end
		 int status=0;
		 CorporateDAO detail=(CorporateDAO)DaoImplInstanceFactory.getDaoImplInstance(CorporateDAO.IDENTITY);
			logger.info("Implementation class: "+detail.getClass());
		 String statusCase="";
		 String updateInMaker="";
		 String updateFlag="";
		 if(session.getAttribute("statusCase")!=null)
		 {
				statusCase = session.getAttribute("statusCase").toString();
		 }	
		 if(session.getAttribute("updateInMaker")!=null)
		 {
			 updateInMaker = session.getAttribute("updateInMaker").toString();
		 }
		 if(session.getAttribute("updateFlag")!=null)
		    {
		    	updateFlag=session.getAttribute("updateFlag").toString();
		    		
		    }
		 Object pageStatus =null;
		 if(session.getAttribute("operation")!=null||session.getAttribute("approve")!=null)
		 {
			 	
			 pageStatus = session.getAttribute("approve");
		 }
		 String pageStatuss="";
		 if(session.getAttribute("pageStatuss")!=null)
		 {
			 pageStatuss = session.getAttribute("pageStatuss").toString();
		 }
		 String addr_id[] = request.getParameterValues("chk");
		 for(int k=0;k<addr_id.length;k++)
		 {
			 logger.info("Address id:--"+addr_id[k]);
			 status = detail.deletesarvaSuraksha(addr_id[k],updateInMaker,statusCase,pageStatus,pageStatuss,updateFlag,source);
		 }
		 String cusType="";
			
			if(session.getAttribute("cusType")!=null)
			{
				cusType=session.getAttribute("cusType").toString();
			}
			
		 if(status>0)
		 {
			 
				 session.removeAttribute("addrList");
				 session.removeAttribute("countryList");
				 session.removeAttribute("detailcountryList");
				 session.removeAttribute("detailcityList");
				 session.removeAttribute("detailregionList");
				 session.removeAttribute("individualInfo");
				 session.removeAttribute("addressInfo");
				 request.setAttribute("closeSuccess", "Updation is Completed Successfully!!!");
				 logger.info("deleteSarvaSuraksha");
				 if(session.getAttribute("idividualId")!=null)
					{
					 return mapping.findForward("deleteSarvaSuraksha");
					}
				 else{
					 return mapping.findForward("deleteCorSarvaSuraksha"); 
				 }
				 
				 
     	  }
		  else
		  {
				 request.setAttribute("status", "Updation is failed!!!"); 
		  }
		return null;
	}
	//Rohit Changes for Sarva Suraksha end.....
}